%% -*- erlang -*-
{cover_enabled, false}.
{deps, [
]}.

{lib_dirs, ["deps"]}.
{erl_opts, [debug_info]}.

{port_specs, [
    {"(darwin|linux|freebsd)", "priv/moon_nif.so", ["c_src/*.cpp"]}
    ,{"win32", "priv/moon_nif.dll", ["c_src/*.cpp"]}
]}.

{port_env, [
    %% necessly config
    {"LUA_PATH", "./deps/lua/src"}
    ,{"BOOST_PATH", "./deps/"}

    %% because make .o use CXX command but link use CC command, it will make mistake : undefined symbol xxxxxxxxx
    ,{"(darwin| linux | freebsd)", "CC", "c++"}

    ,{"(darwin|linux|freebsd)", "CXXFLAGS", "$CXXFLAGS -I$LUA_PATH -I$BOOST_PATH"}

    % if you make with .so
    % ,{"(darwin|linux|freebsd)", "LDFLAGS", "$LDFLAGS -L$LUA_PATH -lluajit"}
    % ifyou make with .a
    ,{"(darwin|linux|freebsd)", "LDFLAGS", "$LDFLAGS -L$LUA_PATH -Wl,-Bstatic -lluajit -Wl,-Bdynamic "}

    %% add your config if you need
    ,{"win32", "CXXFLAGS", "$CXXFLAGS -I$LUA_PATH -I$BOOST_PATH"}
    ,{"win32", "LDFLAGS", "$LDFLAGS -llua51"}
]}.
